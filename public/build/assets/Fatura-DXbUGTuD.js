import{j as e,r as b,y as D,a as $,H as K,c as I}from"./app-5ZeVuGc_.js";import{A as V}from"./AuthenticatedLayout-cjiCYC6A.js";import{M as A,S as C}from"./SecondaryButton-1u5R8ZNZ.js";import{P as R}from"./PrimaryButton-FSx2p_ez.js";import{S as E}from"./ScrollArea-mS4TOEBy.js";import{F as H}from"./FaturaDetailModal-DdcR0l2e.js";import{B as F,A as z}from"./BareButton-DgMgf21a.js";import{T as q}from"./Tooltip-D1fRdeNv.js";import{m as W}from"./proxy-djb_ry30.js";import{E as U}from"./ExportExcel-wL3DYq74.js";/* empty css            */function J(t){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(t||0)}function Q(t){if(!t)return"";const o=new Date(t);if(Number.isNaN(o.getTime()))return"";const u=o.getDate().toString().padStart(2,"0"),c=o.toLocaleDateString("pt-BR",{month:"short"});return`${u} ${c}`}function X({title:t,description:o,amount:u,type:c,status:l,created_at:m,bank_name:i,total_installments:r,current_installment:f,display_installment:s,is_recurring:y,category_name:n,onClick:a}){const d=c==="credit",N=c==="debit",j="-",h="text-rose-500 dark:text-rose-400",v=Math.max(Number(r||1),1),g=Number(u||0)||0,w=v>1?g/v:g,_=Q(m),p=l==="paid"?"Pago":l==="overdue"?"Vencido":"Em aberto",S=l==="paid"?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300":l==="overdue"?"bg-rose-100 text-rose-700 dark:bg-rose-900/40 dark:text-rose-300":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300",x=r&&r>1?s||f||1:null,k=r&&r>1&&x?`${x}/${r}`:null;return e.jsxs("div",{className:"flex items-center justify-between gap-3 px-2 sm:px-3 lg:px-4 py-2 lg:py-2.5 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-900/60 transition cursor-pointer",onClick:a,role:a?"button":void 0,tabIndex:a?0:void 0,children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx("div",{className:"h-9 w-9 lg:h-10 lg:w-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center",children:e.jsx("span",{className:`h-2 w-2 rounded-full ${N||d?"bg-rose-500":"bg-gray-400"}`})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"truncate text-base lg:text-lg font-medium text-gray-900 dark:text-gray-100",children:t}),k&&e.jsx("span",{className:"rounded-full bg-purple-100 px-2.5 py-0.5 text-[11px] sm:text-xs font-semibold uppercase tracking-wide text-purple-700 dark:bg-purple-900/40 dark:text-purple-300",children:k}),y&&e.jsx("span",{className:"rounded-full bg-blue-100 px-2.5 py-0.5 text-[11px] sm:text-xs font-semibold uppercase tracking-wide text-blue-700 dark:bg-blue-900/40 dark:text-blue-300",children:"Recorrente"})]}),e.jsxs("div",{className:"mt-0.5 flex flex-wrap items-center gap-2 text-xs lg:text-sm text-gray-500 dark:text-gray-400",children:[i&&e.jsx("span",{children:i}),n&&e.jsx("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-[11px] sm:text-xs font-medium text-gray-600 dark:bg-gray-800 dark:text-gray-200",children:n}),o&&e.jsxs("span",{className:"truncate max-w-xs",children:["• ",o]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[e.jsxs("span",{className:`text-base lg:text-lg font-semibold ${h}`,children:[j,J(w)]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs lg:text-sm text-gray-500 dark:text-gray-400",children:[_&&e.jsx("span",{children:_}),e.jsx("span",{className:`rounded-full px-2.5 py-0.5 text-[11px] sm:text-xs ${S}`,children:p})]})]})]})}function P(t){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(t||0)}function Y({isOpen:t,onClose:o,monthKey:u,monthLabel:c,items:l=[],bankUserId:m=null,onPaid:i}){const[r,f]=b.useState(!1),s=b.useMemo(()=>l.filter(a=>a.status!=="paid"),[l]),y=b.useMemo(()=>s.reduce((a,d)=>{const N=d.total_installments||1,j=(d.amount||0)/N;return a+j},0),[s]),n=async()=>{if(!r){f(!0),D.dismiss();try{const a={month:u};m&&(a.bank_user_id=m),await $.post(route("faturas.pay_month"),a),D.success("Pagamentos do mês registrados com sucesso."),f(!1),i&&i(),o&&o()}catch(a){console.error(a),f(!1),a.response&&a.response.data?.message?D.error(a.response.data.message):D.error("Erro ao registrar pagamentos do mês.")}}};return e.jsxs(A,{isOpen:t,onClose:o,maxWidth:"md",title:`Pagar fatura de ${c}`,children:[e.jsx("div",{className:"space-y-4 text-sm sm:text-base",children:s.length===0?e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Não há pendências para este mês."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Você está prestes a registrar o pagamento das pendências deste mês."}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white p-3 sm:p-4 text-xs sm:text-sm shadow-sm dark:border-gray-800 dark:bg-[#050505]",children:[e.jsx("p",{className:"mb-2 text-[11px] sm:text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"Pendências do mês"}),e.jsx(E,{maxHeightClassName:"max-h-64",className:"space-y-2 pr-1",children:s.map(a=>{const d=a.total_installments||1,N=a.current_installment||0,j=(a.amount||0)/d,h=d>1?a.display_installment||Math.min(N+1,d):1,v=Math.max(d-(h-1),0);return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-lg bg-gray-50 px-2.5 py-2 text-gray-700 dark:bg-gray-900 dark:text-gray-200",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate text-sm font-medium",children:a.title}),e.jsxs("p",{className:"mt-0.5 text-[11px] sm:text-xs text-gray-500 dark:text-gray-400",children:["Parcela atual: ",h,"/",d," • Valor da parcela: ",P(j)]})]}),e.jsx("div",{className:"text-right text-[11px] sm:text-xs text-gray-500 dark:text-gray-400",children:e.jsxs("p",{children:["Restantes: ",v]})})]},a.id)})}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-dashed border-gray-200 pt-2 text-[11px] sm:text-xs dark:border-gray-700",children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Total a pagar agora"}),e.jsx("span",{className:"font-semibold text-rose-600 dark:text-rose-400",children:P(y)})]})]}),e.jsx("p",{className:"text-[11px] sm:text-xs text-gray-500 dark:text-gray-400",children:'Observação: faturas parceladas só serão marcadas como "pagas" quando todas as parcelas forem quitadas.'})]})}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-3",children:[e.jsx(C,{type:"button",onClick:o,className:"rounded-lg px-4 py-2 text-xs sm:text-sm font-medium text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",children:"Cancelar"}),e.jsx(R,{type:"button",disabled:r||s.length===0,onClick:n,children:r?"Registrando...":"Confirmar pagamento"})]})]})}function Z(t){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(t||0)}function G({month_label:t,total_spent:o,items:u=[],month_key:c,bankUserId:l=null,onPaid:m,is_paid:i=!1,due_day:r=null,isCurrentPending:f=!1}){const[s,y]=b.useState(!1),[n,a]=b.useState("date"),[d,N]=b.useState("desc"),[j,h]=b.useState(null),v=b.useMemo(()=>{const g=[...u];return g.sort((w,_)=>{if(n==="date"){const p=w.created_at?new Date(w.created_at):null,S=_.created_at?new Date(_.created_at):null,x=p&&!Number.isNaN(p.getTime())?p.getTime():0,k=S&&!Number.isNaN(S.getTime())?S.getTime():0;return d==="asc"?x-k:k-x}if(n==="amount"){const p=Number(w.amount)||0,S=Number(_.amount)||0;return d==="asc"?p-S:S-p}return 0}),g},[u,n,d]);return e.jsxs("section",{className:"space-y-4 sm:space-y-5 lg:space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-start gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"flex-1 flex justify-start items-center gap-3 sm:gap-4",children:e.jsxs("div",{className:"inline-flex flex-col items-start rounded-2xl sm:rounded-full px-4 py-2 sm:px-6 sm:py-3 bg-transparent",children:[r&&e.jsxs("p",{className:"mt-0.5 text-xs sm:text-sm lg:text-base text-gray-500 dark:text-gray-400",children:["Vencimento do cartão: todo dia ",e.jsx("span",{className:"font-semibold",children:r})]}),e.jsxs("p",{className:"mt-1 text-xs sm:text-sm lg:text-base text-gray-500 dark:text-gray-400",children:["Total de despesas do mês",":",e.jsx("span",{className:"ml-1 font-semibold text-rose-600 dark:text-rose-400",children:Z(o)})]})]})}),f&&e.jsx(R,{type:"button",onClick:()=>y(!0),className:"shrink-0 rounded-full px-4 py-2 text-[11px] sm:text-xs font-semibold uppercase tracking-wide focus:ring-rose-500 focus:ring-offset-2 dark:ring-offset-[#050505] w-full sm:w-auto",children:"Pagar"})]}),e.jsx("div",{className:"rounded-2xl bg-white border border-gray-50/90 dark:border-red-950/50 px-2 py-2 sm:px-3 sm:py-3 lg:px-5 lg:py-4 shadow-sm ring-1 ring-black/5 dark:bg-[#080808] dark:ring-white/5 shadow-gray-500 dark:shadow-gray-900",children:u.length===0?e.jsx("p",{className:"px-3 py-3 text-sm sm:text-base text-gray-500 dark:text-gray-400",children:"Nenhuma transação neste mês."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between px-3 pt-2 pb-1 text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"font-semibold uppercase tracking-wide",children:"Ordenar"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{type:"button",onClick:()=>a("date"),className:`inline-flex items-center rounded-full border px-3 py-1.5 text-[11px] sm:text-xs font-medium transition ${n==="date"?"border-[#7b1818] bg-[#7b1818] text-white shadow-sm dark:border-rose-500 dark:bg-rose-500":"border-gray-300 bg-white text-gray-600 hover:bg-gray-50 dark:border-gray-700 dark:bg-[#050505] dark:text-gray-200 dark:hover:bg-gray-800"}`,children:"Data"}),e.jsx(F,{type:"button",onClick:()=>a("amount"),className:`inline-flex items-center rounded-full border px-3 py-1.5 text-[11px] sm:text-xs font-medium transition ${n==="amount"?"border-[#7b1818] bg-[#7b1818] text-white shadow-sm dark:border-rose-500 dark:bg-rose-500":"border-gray-300 bg-white text-gray-600 hover:bg-gray-50 dark:border-gray-700 dark:bg-[#050505] dark:text-gray-200 dark:hover:bg-gray-800"}`,children:"Valor"}),e.jsx(q,{label:d==="desc"?"Do mais recente/mais caro para o mais antigo/mais barato":"Do mais antigo/mais barato para o mais recente/mais caro",children:e.jsx(F,{type:"button",onClick:()=>N(g=>g==="desc"?"asc":"desc"),className:"inline-flex items-center rounded-full border border-gray-300 bg-white px-2.5 py-1.5 text-[11px] sm:text-xs font-medium text-gray-600 shadow-sm hover:bg-gray-50 dark:border-gray-700 dark:bg-[#050505] dark:text-gray-200 dark:hover:bg-gray-800",children:d==="desc"?"▼":"▲"})})]})]}),e.jsx(E,{className:"divide-y divide-gray-100 dark:divide-gray-800",children:v.map(g=>e.jsx(X,{...g,onClick:()=>h(g)},g.id))})]})}),e.jsx(Y,{isOpen:s,onClose:()=>y(!1),monthKey:c,monthLabel:t,items:u,bankUserId:l,onPaid:m}),e.jsx(H,{isOpen:!!j,onClose:()=>h(null),item:j})]})}function ee({months:t=[],total_spent:o,selectedMonthKey:u,onChangeMonth:c}){if(!t||t.length===0)return null;const l=t.findIndex(g=>g.month_key===u),m=l===-1?0:l,i=t[m],r=t[m+1]||null,f=t[m-1]||null,s=i?.is_paid,y=!!r,n=!!f,[a,d]=b.useState(0),N=()=>{y&&(d(-1),c(r.month_key))},j=()=>{n&&(d(1),c(f.month_key))},h={enter:g=>({x:g>0?100:-100,opacity:0,scale:.96}),center:{x:0,opacity:1,scale:1,transition:{type:"spring",stiffness:260,damping:25}},exit:g=>({x:g<0?100:-100,opacity:0,scale:.96,transition:{duration:.18}})};function v(g){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(g||0)}return e.jsxs("div",{className:"flex flex-col items-stretch gap-3 sm:flex-row sm:items-center sm:justify-center sm:gap-4 lg:gap-6",children:[e.jsx("div",{className:"flex justify-between sm:w-32 sm:justify-end",children:r&&e.jsx(C,{type:"button",onClick:N,className:"rounded-full px-3 py-1 text-[11px] font-medium text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-900 border-none shadow-none",children:r.month_label})}),e.jsx("div",{className:"flex-1 flex justify-center",children:e.jsx(z,{custom:a,initial:!1,mode:"wait",children:e.jsxs(W.div,{custom:a,variants:h,initial:"enter",animate:"center",exit:"exit",className:`inline-flex flex-col items-center rounded-full px-6 py-3 sm:px-8 sm:py-3 lg:px-10 lg:py-4 shadow-sm ring-1 bg-gradient-to-r dark:bg-gradient-to-r ${s?"from-emerald-50 via-white to-emerald-50 ring-emerald-200 dark:from-[#052e26] dark:via-[#050505] dark:to-[#052e26] dark:ring-emerald-900/50":"from-rose-50 via-white to-rose-50 ring-rose-100 dark:from-[#150709] dark:via-[#0b0b0b] dark:to-[#150709] dark:ring-rose-900/40"}`,children:[s?e.jsx("span",{className:"text-sm font-medium text-emerald-600 dark:text-emerald-400",children:"Paga"}):e.jsx("div",{}),e.jsx("span",{className:`mt-1 text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold tracking-tight ${s?"text-emerald-600 dark:text-emerald-400":"text-gray-900 dark:text-gray-50"}`,children:i.month_label}),e.jsx("span",{className:`font-semibold text-2xl sm:text-3xl lg:text-4xl ${s?"text-emerald-600 dark:text-emerald-400":"text-rose-600 dark:text-rose-400"}`,children:v(o)})]},i.month_key)})}),e.jsx("div",{className:"flex justify-between sm:w-32 sm:justify-start",children:f&&e.jsx(C,{type:"button",onClick:j,className:"rounded-full px-3 py-1 text-[11px] font-medium text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-900 border-none shadow-none",children:f.month_label})})]})}function te({monthlyGroups:t=[]}){const{rows:o,header:u}=b.useMemo(()=>{if(!t||t.length===0)return{rows:[],header:{}};const c=[],l={};t.forEach(n=>{!n||!n.month_key||n.is_paid||(c.push(n.month_key),n.month_label&&(l[n.month_key]=n.month_label))});const m=Array.from(new Set(c)).sort(),i=new Map;t.forEach(n=>{const a=n.month_key;!a||n.is_paid||!n.items||n.items.forEach(d=>{if(!d||d.status==="paid")return;const N=d.category_name||d.title||"Sem categoria",j=N,h=Math.max(Number(d.total_installments||1),1),g=(Number(d.amount||0)||0)/h;if(!i.has(j)){const _={label:N};m.forEach(p=>{_[p]=0}),_.total=0,i.set(j,_)}const w=i.get(j);w[a]=Number(w[a]||0)+g,w.total=Number(w.total||0)+g})});const r=Array.from(i.values());if(r.length===0)return{rows:[],header:{}};const f={label:"TOTAL GERAL"};let s=0;m.forEach(n=>{let a=0;r.forEach(d=>{a+=Number(d[n]||0)}),s+=a,f[n]=a}),f.total=s,r.push(f);const y={label:{name:"Categoria / Compra"}};return m.forEach(n=>{y[n]={name:l[n]||n}}),y.total={name:"TOTAL"},{rows:r,header:y}},[t]);return!o||o.length===0?null:e.jsx(U,{data:o,header:u,name:"faturas_pendentes"})}function T(...t){return t.filter(Boolean).join(" ")}function ae({months:t=[],value:o,onChange:u}){const[c,l]=b.useState(!1),m=b.useRef(null),i=b.useRef(null),r=t.find(s=>s.month_key===o)||t[0]||null;if(b.useEffect(()=>{if(!c)return;const s=y=>{i.current&&!i.current.contains(y.target)&&m.current&&!m.current.contains(y.target)&&l(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[c]),!t||t.length===0)return null;const f=s=>{u&&u(s),l(!1)};return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsxs("button",{type:"button",ref:m,onClick:()=>l(s=>!s),className:"inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-xs lg:text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-rose-500 focus:border-rose-500 dark:border-gray-700 dark:bg-[#0f0f0f] dark:text-gray-100",children:[e.jsx("span",{className:"inline-flex flex-col text-left",children:e.jsxs("span",{className:"text-xs lg:text-sm font-medium text-gray-900 dark:text-gray-100",children:[r?r.month_label:"Selecione um mês",r&&r.is_paid?" (paga)":""]})}),e.jsx("svg",{className:T("h-4 w-4 text-gray-500 dark:text-gray-400 transition-transform",c?"rotate-180":"rotate-0"),viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5.25 7.5L10 12.25L14.75 7.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]}),c&&e.jsx("div",{ref:i,className:"absolute right-0 z-20 mt-2 w-72 sm:w-96 origin-top-right rounded-2xl bg-white p-3 shadow-xl ring-1 ring-black/5 dark:bg-[#050505] dark:ring-black/40",children:e.jsx(E,{maxHeightClassName:"max-h-64",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mr-2",children:t.map(s=>{const y=s.month_key===(r&&r.month_key);return s.is_paid,e.jsx("button",{type:"button",onClick:()=>f(s.month_key),className:T("flex flex-col items-start rounded-xl border px-2.5 py-2 text-left transition-colors","hover:border-rose-400 hover:bg-rose-50/60 dark:hover:border-rose-500/70 dark:hover:bg-rose-900/20",y?"border-rose-500 bg-rose-50 dark:border-rose-500/80 dark:bg-rose-900/30":"border-gray-200 bg-gray-50/60 dark:border-gray-800 dark:bg-[#050505]"),children:e.jsx("span",{className:"text-lg font-medium text-gray-800 dark:text-gray-100 leading-tight",children:s.month_label})},s.month_key)})})})})]})}function re({bankAccounts:t=[],categories:o=[],filters:u={},months:c=[],monthValue:l,onFiltersChange:m,onMonthChange:i}){const r=u?.bank_user_id??"",f=u?.category_id??"",s=a=>{const d=a.target.value||void 0;m&&m({bank_user_id:d,category_id:f||void 0})},y=a=>{const d=a.target.value||void 0;m&&m({bank_user_id:r||void 0,category_id:d})},n=a=>{!a||!i||i(a)};return e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm sm:text-base",children:[e.jsxs("select",{value:r||"",onChange:s,className:"min-w-[200px] sm:min-w-[220px] lg:min-w-[260px] rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm sm:text-base shadow-sm focus:border-rose-500 focus:ring-rose-500 dark:border-gray-700 dark:bg-[#0f0f0f] dark:text-gray-100",children:[e.jsx("option",{value:"",children:"Todos os bancos"}),t.map(a=>e.jsxs("option",{value:a.id,children:[a.name,a.due_day?` - vence todo dia ${a.due_day}`:""]},a.id))]}),e.jsxs("select",{value:f||"",onChange:y,className:"min-w-[200px] sm:min-w-[220px] lg:min-w-[260px] rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm sm:text-base shadow-sm focus:border-rose-500 focus:ring-rose-500 dark:border-gray-700 dark:bg-[#0f0f0f] dark:text-gray-100",children:[e.jsx("option",{value:"",children:"Todas as categorias"}),o.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),c&&c.length>0&&e.jsx(ae,{months:c,value:l,onChange:n})]})}function B(t){if(!t||typeof t!="string")return 0;const[o,u]=t.split("-"),c=parseInt(o,10)||0,l=parseInt(u,10)||0;return c*12+(l-1)}function L(t,o){if(!t||t.length===0)return null;if(o){if(t.some(i=>i.month_key===o))return o;const c=B(o);let l=t[0],m=Math.abs(B(l.month_key)-c);for(const i of t){const r=Math.abs(B(i.month_key)-c);r<m&&(l=i,m=r)}return l.month_key}return t[0].month_key}function fe({monthlyGroups:t=[],bankAccounts:o=[],categories:u=[],filters:c={},currentMonthKey:l=null}){const m=c?.bank_user_id??"",[i,r]=b.useState(()=>L(t,l)),[f,s]=b.useState(!1),[y,n]=b.useState(""),[a,d]=b.useState(!1),N=x=>{["Backspace","Tab","ArrowLeft","ArrowRight","Delete","Home","End"].includes(x.key)||/^[0-9]$/.test(x.key)||x.preventDefault()};b.useEffect(()=>{if(!t||t.length===0){r(null);return}if(!t.some(k=>k.month_key===i)){const k=L(t,l);r(k)}},[t,i,l]);const j=x=>{I.get(route("faturas.index"),x,{preserveState:!0,preserveScroll:!0})},h=o&&o.length>0&&m?o.find(x=>String(x.id)===String(m)):null,v=x=>{r(x)},g=()=>{h&&(n(h.due_day?String(h.due_day):""),s(!0))},w=async x=>{if(x.preventDefault(),!h||a)return;const k=parseInt(y,10);if(Number.isNaN(k)||k<1||k>31){D.error("Informe um dia de vencimento entre 1 e 31.");return}d(!0),D.dismiss();try{await $.patch(route("banks.update-due-day",h.id),{due_day:k}),D.success("Dia de vencimento atualizado com sucesso."),s(!1),I.reload({only:["bankAccounts"]})}catch(M){console.error(M),D.error("Não foi possível atualizar o dia de vencimento.")}finally{d(!1)}},_=()=>{if(!t||t.length===0||!p){I.reload({only:["monthlyGroups"],preserveState:!0});return}const x=t.findIndex(O=>O.month_key===p.month_key),k=x>0?x-1:x,M=t[k]||p;r(M.month_key),I.reload({only:["monthlyGroups"],preserveState:!0})},p=t&&t.length>0?t.find(x=>x.month_key===i)||t[0]:null,S=L(t,l);return e.jsxs(V,{children:[e.jsx(K,{title:"Faturas"}),e.jsxs("div",{className:"w-full max-w-[1600px] mx-auto px-3 sm:px-4 lg:px-8 space-y-5 sm:space-y-6 lg:space-y-7",children:[e.jsxs("header",{className:"pt-1 sm:pt-2 space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-semibold text-gray-900 mb-1 dark:text-gray-100",children:"Faturas"}),e.jsx("p",{className:"text-sm sm:text-base lg:text-lg text-gray-600 dark:text-gray-300",children:"Visualize suas despesas agrupadas por mês."})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx(re,{bankAccounts:o,categories:u,filters:c,months:t,monthValue:p?.month_key||i,onFiltersChange:j,onMonthChange:v}),e.jsx("div",{className:"flex justify-start md:justify-end",children:e.jsx(te,{monthlyGroups:t})})]}),h&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs sm:text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("span",{children:["Dia de vencimento:"," ",h.due_day?`todo dia ${h.due_day}`:"ainda não definido"]}),e.jsx(C,{type:"button",onClick:g,className:"rounded-full px-4 py-1.5 text-[11px] sm:text-xs font-semibold uppercase tracking-wide text-rose-600 border border-rose-500 hover:bg-rose-50 dark:border-rose-500/70 dark:text-rose-300 dark:hover:bg-rose-900/20",children:"Definir dia de vencimento"})]})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-5 pb-6 sm:pb-8",children:[(!t||t.length===0)&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Nenhuma fatura encontrada para o filtro atual."}),t&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{months:t,selectedMonthKey:p?.month_key,onChangeMonth:v,...p}),p&&e.jsx(G,{...p,month_key:p.month_key,bankUserId:m||null,due_day:h?.due_day??null,onPaid:_,isCurrentPending:S&&p.month_key===S&&!p.is_paid},p.month_key)]})]}),e.jsx(A,{isOpen:f,onClose:()=>!a&&s(!1),maxWidth:"sm",title:"Definir dia de vencimento",children:e.jsxs("form",{className:"space-y-4",onSubmit:w,noValidate:!0,children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"Dia de vencimento do cartão (1 a 31)"}),e.jsx("input",{type:"number",min:1,max:31,inputMode:"numeric",onKeyDown:N,value:y,onChange:x=>n(x.target.value),className:"w-full rounded-md border border-gray-300 bg-white p-2 text-sm shadow-sm dark:border-gray-700 dark:bg-[#0f0f0f] dark:text-gray-100"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2 text-xs",children:[e.jsx(C,{type:"button",onClick:()=>!a&&s(!1),className:"rounded-lg px-4 py-2 font-medium text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",children:"Cancelar"}),e.jsx(R,{type:"submit",disabled:a,className:"rounded-lg px-4 py-2 font-semibold uppercase tracking-wide disabled:cursor-not-allowed",children:a?"Salvando...":"Salvar dia"})]})]})})]})]})}export{fe as default};
