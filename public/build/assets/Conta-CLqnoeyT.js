import{r as l,j as e,H as J,y as i,a as j}from"./app-DT0idBIm.js";import{A as Q}from"./AuthenticatedLayout-C2x3_7lg.js";import{S as u,M as B}from"./SecondaryButton-DUJQvJ1I.js";import{P as z}from"./PrimaryButton-D3leuIme.js";import{D}from"./DangerButton-C_1CIe0M.js";import{S as R}from"./ScrollArea-D3rjwK3d.js";import{P as H}from"./Pagination-BcSQlHxg.js";/* empty css            */import"./proxy-Bx2-buuD.js";import"./BareButton-BQ6URbuj.js";function X(r){return r?`Todo dia ${r}`:"Não definido"}function ie({bankAccounts:r,categories:n}){const L=Array.isArray(r?.data)?r.data:Array.isArray(r)?r:[],[v,N]=l.useState(L),T=Array.isArray(n?.data)?n.data:Array.isArray(n)?n:[],[C,w]=l.useState(T),[t,x]=l.useState(!1),[K,y]=l.useState(!1),[f,h]=l.useState(null),[A,I]=l.useState(""),[P,b]=l.useState(!1),[S,k]=l.useState(null),[M,O]=l.useState(""),[W,m]=l.useState(!1),[d,c]=l.useState({type:null,id:null,name:""});l.useEffect(()=>{const a=Array.isArray(r?.data)?r.data:Array.isArray(r)?r:[];N(a)},[r]),l.useEffect(()=>{const a=Array.isArray(n?.data)?n.data:Array.isArray(n)?n:[];w(a)},[n]);const F=a=>{h(a),I(a.due_day?String(a.due_day):""),y(!0)},U=async a=>{if(a.preventDefault(),!f||t)return;const s=A.trim(),o=parseInt(s,10);if(Number.isNaN(o)||o<1||o>31){i.error("Informe um dia de vencimento entre 1 e 31.");return}x(!0);try{await j.patch(route("banks.update-due-day",f.id),{due_day:o}),N(p=>p.map(g=>g.id===f.id?{...g,due_day:o}:g)),i.success("Dia de vencimento atualizado."),y(!1),h(null)}catch(p){console.error(p),i.error("Não foi possível atualizar o dia de vencimento.")}finally{x(!1)}},V=a=>{["Backspace","Tab","ArrowLeft","ArrowRight","Delete","Home","End"].includes(a.key)||/^[0-9]$/.test(a.key)||a.preventDefault()},$=a=>{k(a),O(a.name||""),b(!0)},q=async a=>{if(a.preventDefault(),!S||t)return;const s=M.trim();if(!s){i.error("O nome da categoria não pode ser vazio.");return}x(!0);try{const p=(await j.put(route("categories.update",S.id),{name:s})).data;w(g=>g.map(E=>E.id===S.id?{...E,name:p.name}:E)),i.success("Categoria atualizada."),b(!1),k(null)}catch(o){console.error(o),i.error("Não foi possível atualizar a categoria.")}finally{x(!1)}},_=(a,s)=>{a==="bank"?c({type:"bank",id:s.bankId,name:s.name}):a==="category"&&c({type:"category",id:s.categoryId,name:s.name}),m(!0)},G=async()=>{if(!d.type||!d.id){m(!1);return}x(!0);try{d.type==="bank"&&(await j.delete(route("banks.destroy",d.id)),N(a=>a.filter(s=>s.bank_id!==d.id)),i.success("Conta removida com sucesso.")),d.type==="category"&&(await j.delete(route("categories.destroy",d.id)),w(a=>a.filter(s=>s.id!==d.id)),i.success("Categoria removida."))}catch(a){console.error(a),d.type==="bank"?i.error("Não foi possível remover a conta."):i.error("Não foi possível remover a categoria.")}finally{x(!1),m(!1),c({type:null,id:null,name:""})}};return e.jsxs(Q,{children:[e.jsx(J,{title:"Contas"}),e.jsxs("div",{className:"w-full max-w-[1450px] 2xl:max-w-[1500px] mx-auto px-3 py-2 space-y-3 sm:px-4 sm:py-3 lg:px-5 lg:py-4",children:[e.jsxs("header",{className:"space-y-1",children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Contas"}),e.jsx("p",{className:"text-xs sm:text-sm lg:text-sm text-gray-600 dark:text-gray-300",children:"Gerencie as contas bancárias vinculadas e as categorias usadas nas suas transações."})]}),e.jsxs("section",{className:"rounded-2xl bg-white p-3 sm:p-3 lg:p-3 shadow-md ring-1 ring-black/5 dark:bg-[#0b0b0b] dark:ring-black/30",children:[e.jsxs("div",{className:"mb-2 flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("h2",{className:"text-base sm:text-lg lg:text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Contas / bancos vinculados"}),t&&e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:"Salvando..."})]}),v&&v.length>0?e.jsxs(e.Fragment,{children:[e.jsx(R,{maxHeightClassName:"max-h-[260px] md:max-h-[280px] lg:max-h-[300px] 2xl:max-h-[300px]",className:"space-y-2",children:v.map(a=>e.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border border-gray-200 px-3 py-2 text-sm sm:text-base lg:text-base shadow-sm dark:border-gray-800 dark:bg-black sm:flex-row sm:items-center sm:justify-between sm:py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.name}),e.jsx("div",{className:"text-xs sm:text-sm lg:text-sm text-gray-500 dark:text-gray-400",children:X(a.due_day)})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs sm:text-sm lg:text-sm sm:flex-nowrap",children:[e.jsx(u,{type:"button",onClick:()=>F(a),className:"rounded-full px-4 py-1.5 text-[11px] sm:text-xs lg:text-sm font-semibold uppercase tracking-wide text-rose-600 border border-rose-500 hover:bg-rose-50 dark:border-rose-500/70 dark:text-rose-300 dark:hover:bg-rose-900/20",children:"Alterar vencimento"}),e.jsx(D,{type:"button",onClick:()=>_("bank",{bankId:a.bank_id,name:a.name}),className:"rounded-full px-4 py-1.5 text-[11px] sm:text-xs lg:text-sm font-semibold uppercase tracking-wide",children:"Remover"})]})]},a.id))}),e.jsx(H,{links:r?.links||[]})]}):e.jsx("p",{className:"text-xs sm:text-sm lg:text-base text-gray-500 dark:text-gray-400",children:"Nenhuma conta vinculada. Use o Dashboard ou as ações rápidas para adicionar um banco."})]}),e.jsxs("section",{className:"rounded-2xl bg-white p-3 shadow-md ring-1 ring-black/5 dark:bg-[#0b0b0b] dark:ring-black/30 sm:p-3 lg:p-3",children:[e.jsxs("div",{className:"mb-2 flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("h2",{className:"text-base sm:text-lg lg:text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Categorias"}),t&&e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:"Salvando..."})]}),C&&C.length>0?e.jsxs(e.Fragment,{children:[e.jsx(R,{maxHeightClassName:"max-h-[200px] md:max-h-[220px] lg:max-h-[240px] 2xl:max-h-[240px]",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-800 text-xs sm:text-sm lg:text-sm",children:C.map(a=>e.jsxs("li",{className:"flex flex-col gap-2 py-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:a.name}),e.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 text-[11px] sm:text-xs lg:text-sm sm:flex-nowrap",children:[e.jsx(u,{type:"button",onClick:()=>$(a),className:"rounded-full px-3.5 py-1.5 text-[11px] sm:text-xs lg:text-sm font-semibold uppercase tracking-wide text-rose-600 border border-rose-500 hover:bg-rose-50 dark:border-rose-500/70 dark:text-rose-300 dark:hover:bg-rose-900/20",children:"Renomear"}),e.jsx(D,{type:"button",onClick:()=>_("category",{categoryId:a.id,name:a.name}),className:"rounded-full px-3.5 py-1.5 text-[11px] sm:text-xs lg:text-sm font-semibold uppercase tracking-wide",children:"Remover"})]})]},a.id))})}),e.jsx(H,{links:n?.links||[]})]}):e.jsx("p",{className:"text-xs sm:text-sm lg:text-base text-gray-500 dark:text-gray-400",children:"Nenhuma categoria cadastrada. Use as ações rápidas para criar novas categorias."})]})]}),e.jsx(B,{isOpen:K,onClose:()=>{t||(y(!1),h(null))},maxWidth:"lg",title:"Editar vencimento da conta",children:e.jsxs("form",{className:"space-y-3",onSubmit:U,noValidate:!0,children:[e.jsxs("p",{className:"text-base sm:text-lg text-gray-600 dark:text-gray-300",children:["Conta:"," ",e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:f?.name||""})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-700 dark:text-gray-200",children:"Dia de vencimento (1 a 31)"}),e.jsx("input",{type:"number",min:1,max:31,inputMode:"numeric",onKeyDown:V,value:A,onChange:a=>I(a.target.value),className:"w-full rounded-md border border-gray-300 bg-white p-2 text-sm sm:text-base shadow-sm dark:border-gray-700 dark:bg-[#0f0f0f] dark:text-gray-100",placeholder:"Ex: 10"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2 text-xs sm:text-sm",children:[e.jsx(u,{type:"button",onClick:()=>{t||(y(!1),h(null))},className:"rounded-lg px-4 py-2 font-medium text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",children:"Cancelar"}),e.jsx(z,{type:"submit",disabled:t,children:t?"Salvando...":"Salvar"})]})]})}),e.jsx(B,{isOpen:P,onClose:()=>{t||(b(!1),k(null))},maxWidth:"lg",title:"Editar categoria",children:e.jsxs("form",{className:"space-y-3",onSubmit:q,noValidate:!0,children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm sm:text-base font-medium text-gray-700 dark:text-gray-200",children:"Nome da categoria"}),e.jsx("input",{type:"text",value:M,onChange:a=>O(a.target.value),className:"w-full rounded-md border border-gray-300 p-2 text-sm sm:text-base shadow-sm dark:border-gray-700 dark:bg-[#0f0f0f] dark:text-gray-100",placeholder:"Ex: Mercado, Lazer, Shopping"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2 text-xs sm:text-sm",children:[e.jsx(u,{type:"button",onClick:()=>{t||(b(!1),k(null))},className:"rounded-lg px-4 py-2 font-medium text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",children:"Cancelar"}),e.jsx(z,{type:"submit",disabled:t,children:t?"Salvando...":"Salvar"})]})]})}),e.jsx(B,{isOpen:W,onClose:()=>{t||(m(!1),c({type:null,id:null,name:""}))},maxWidth:"sm",title:"Confirmar exclusão",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-300",children:["Tem certeza de que deseja remover"," ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:d.name}),"?"]}),e.jsx("p",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"Essa ação não poderá ser desfeita."}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2 text-xs sm:text-sm",children:[e.jsx(u,{type:"button",onClick:()=>{t||(m(!1),c({type:null,id:null,name:""}))},className:"rounded-lg px-4 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",children:"Cancelar"}),e.jsx(D,{type:"button",onClick:G,disabled:t,children:t?"Removendo...":"Remover"})]})]})})]})}export{ie as default};
